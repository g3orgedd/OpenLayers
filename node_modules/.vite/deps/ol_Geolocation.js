import {
  circular
} from "./chunk-MZNUYK7V.js";
import "./chunk-42AUXAXR.js";
import "./chunk-3Y5AWGM3.js";
import "./chunk-JEC7CYPK.js";
import "./chunk-2EEEFOKJ.js";
import "./chunk-NPDENEHC.js";
import "./chunk-ZHG2RUY5.js";
import {
  get,
  getTransformFromProjections,
  identityTransform
} from "./chunk-HAHZNQA5.js";
import "./chunk-FDCY5XRG.js";
import "./chunk-W2AZARKC.js";
import "./chunk-AQ4AE3Z5.js";
import "./chunk-VXW2LBXG.js";
import {
  EventType_default,
  Event_default,
  Object_default
} from "./chunk-JIF37MCL.js";
import "./chunk-LJ2RWGJR.js";
import {
  toRadians
} from "./chunk-PAQUSFNP.js";
import "./chunk-HUBM7RA2.js";

// node_modules/ol/Geolocation.js
var Property = {
  ACCURACY: "accuracy",
  ACCURACY_GEOMETRY: "accuracyGeometry",
  ALTITUDE: "altitude",
  ALTITUDE_ACCURACY: "altitudeAccuracy",
  HEADING: "heading",
  POSITION: "position",
  PROJECTION: "projection",
  SPEED: "speed",
  TRACKING: "tracking",
  TRACKING_OPTIONS: "trackingOptions"
};
var GeolocationError = class extends Event_default {
  constructor(error) {
    super(EventType_default.ERROR);
    this.code = error.code;
    this.message = error.message;
  }
};
var Geolocation = class extends Object_default {
  constructor(options) {
    super();
    this.on;
    this.once;
    this.un;
    options = options || {};
    this.position_ = null;
    this.transform_ = identityTransform;
    this.watchId_ = void 0;
    this.addChangeListener(Property.PROJECTION, this.handleProjectionChanged_);
    this.addChangeListener(Property.TRACKING, this.handleTrackingChanged_);
    if (options.projection !== void 0) {
      this.setProjection(options.projection);
    }
    if (options.trackingOptions !== void 0) {
      this.setTrackingOptions(options.trackingOptions);
    }
    this.setTracking(options.tracking !== void 0 ? options.tracking : false);
  }
  disposeInternal() {
    this.setTracking(false);
    super.disposeInternal();
  }
  handleProjectionChanged_() {
    const projection = this.getProjection();
    if (projection) {
      this.transform_ = getTransformFromProjections(
        get("EPSG:4326"),
        projection
      );
      if (this.position_) {
        this.set(Property.POSITION, this.transform_(this.position_));
      }
    }
  }
  handleTrackingChanged_() {
    if ("geolocation" in navigator) {
      const tracking = this.getTracking();
      if (tracking && this.watchId_ === void 0) {
        this.watchId_ = navigator.geolocation.watchPosition(
          this.positionChange_.bind(this),
          this.positionError_.bind(this),
          this.getTrackingOptions()
        );
      } else if (!tracking && this.watchId_ !== void 0) {
        navigator.geolocation.clearWatch(this.watchId_);
        this.watchId_ = void 0;
      }
    }
  }
  positionChange_(position) {
    const coords = position.coords;
    this.set(Property.ACCURACY, coords.accuracy);
    this.set(
      Property.ALTITUDE,
      coords.altitude === null ? void 0 : coords.altitude
    );
    this.set(
      Property.ALTITUDE_ACCURACY,
      coords.altitudeAccuracy === null ? void 0 : coords.altitudeAccuracy
    );
    this.set(
      Property.HEADING,
      coords.heading === null ? void 0 : toRadians(coords.heading)
    );
    if (!this.position_) {
      this.position_ = [coords.longitude, coords.latitude];
    } else {
      this.position_[0] = coords.longitude;
      this.position_[1] = coords.latitude;
    }
    const projectedPosition = this.transform_(this.position_);
    this.set(Property.POSITION, projectedPosition);
    this.set(Property.SPEED, coords.speed === null ? void 0 : coords.speed);
    const geometry = circular(this.position_, coords.accuracy);
    geometry.applyTransform(this.transform_);
    this.set(Property.ACCURACY_GEOMETRY, geometry);
    this.changed();
  }
  positionError_(error) {
    this.dispatchEvent(new GeolocationError(error));
  }
  getAccuracy() {
    return this.get(Property.ACCURACY);
  }
  getAccuracyGeometry() {
    return this.get(Property.ACCURACY_GEOMETRY) || null;
  }
  getAltitude() {
    return this.get(Property.ALTITUDE);
  }
  getAltitudeAccuracy() {
    return this.get(Property.ALTITUDE_ACCURACY);
  }
  getHeading() {
    return this.get(Property.HEADING);
  }
  getPosition() {
    return this.get(Property.POSITION);
  }
  getProjection() {
    return this.get(Property.PROJECTION);
  }
  getSpeed() {
    return this.get(Property.SPEED);
  }
  getTracking() {
    return this.get(Property.TRACKING);
  }
  getTrackingOptions() {
    return this.get(Property.TRACKING_OPTIONS);
  }
  setProjection(projection) {
    this.set(Property.PROJECTION, get(projection));
  }
  setTracking(tracking) {
    this.set(Property.TRACKING, tracking);
  }
  setTrackingOptions(options) {
    this.set(Property.TRACKING_OPTIONS, options);
  }
};
var Geolocation_default = Geolocation;

// dep:ol_Geolocation
var ol_Geolocation_default = Geolocation_default;
export {
  ol_Geolocation_default as default
};
//# sourceMappingURL=ol_Geolocation.js.map
